<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title> موقع تجاري </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- CKEditor 5 -->
  <script src="https://cdn.ckeditor.com/ckeditor5/36.0.1/classic/ckeditor.js"></script>
  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    /* الإعدادات الأساسية */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: Arial, sans-serif;
      background-image: url('background.jpg');
      background-size: cover;
      background-attachment: fixed;
      background-color: #f8f8f8;
      color: #333;
      direction: rtl;
      padding-top: 120px;
    }
    /* الشريط العلوي الثابت والدراج */
    .top-bar {
      position: fixed; top: 0; left: 0; width: 100%;
      background-color: #ffffff;
      border-bottom: 1px solid #6a0dad;
      padding: 10px 20px;
      display: flex; align-items: center; justify-content: space-between;
      z-index: 1001; cursor: move;
    }
    .top-bar input[type="text"] {
      width: 60%; padding: 10px;
      border: 1px solid #ccc; border-radius: 20px;
      color: #333; background: #fff;
      transition: box-shadow 0.3s ease;
    }
    .top-bar input[type="text"]:focus {
      outline: none; box-shadow: 0 2px 10px rgba(0,0,0,0.15);
    }
    .top-bar button.search-btn {
      background-color: #6a0dad; border: none; color: #fff;
      padding: 10px 15px; cursor: pointer; border-radius: 4px; margin-left: 5px;
      transition: background-color 0.3s;
    }
    .top-bar button.search-btn:hover { background-color: #ffd700; color: #000; }
    /* شريط التنقل الرئيسي مع التمرير الأفقي */
    .main-nav {
      position: fixed; top: 60px; left: 0; width: 100%;
      background-color: #ffffff; border-bottom: 1px solid #6a0dad;
      padding: 10px 0; 
      display: flex; 
      justify-content: center; 
      z-index: 1000;
      overflow-x: auto;
      white-space: nowrap;
    }
    .main-nav button {
      background-color: #6a0dad; border: none; color: #fff;
      padding: 10px 15px; margin: 0 5px; cursor: pointer; border-radius: 4px;
      font-size: 16px; transition: background-color 0.3s;
      display: inline-block;
    }
    .main-nav button:hover { background-color: #ffd700; color: #000; }
    /* القائمة الجانبية */
    .side-menu {
      position: fixed; top: 0; right: -250px; width: 250px; height: 100%;
      background-color: #6a0dad; transition: right 0.3s ease; padding: 20px; z-index: 1100;
    }
    .side-menu.open { right: 0; }
    .side-menu h3 { margin-bottom: 10px; color: #fff; }
    /* تم إزالة زر دخول المدير الخاص بنظام التحرير */
    .side-menu button {
      background-color: #6a0dad; border: 2px solid transparent; color: #fff; padding: 8px 12px;
      margin: 5px 0; cursor: pointer; border-radius: 4px; width: 100%; text-align: center;
      transition: background-color 0.3s, border-color 0.3s;
    }
    .side-menu ul { list-style: none; margin-top: 15px; }
    .side-menu ul li { margin: 8px 0; display: flex; align-items: center; }
    .side-menu ul li img { width: 20px; height: 20px; margin-left: 8px; }
    .side-menu ul li a { color: #fff; text-decoration: none; }
    /* الأقسام */
    .section {
      display: none; padding: 20px; background-color: #fff; color: #333;
      min-height: 200px; margin: 20px; border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .section.active { display: block; }
    .section h2 {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    /* تم إزالة أزرار الإضافة الخاصة بالمدير */
    .add-item-btn, .add-meal-btn { display: none; }
    .sub-nav { margin: 10px 0; }
    .sub-nav button {
      background-color: #6a0dad; color: #fff; border: none;
      margin: 0 5px; padding: 8px 12px; cursor: pointer; border-radius: 4px;
      transition: background-color 0.3s;
    }
    .sub-nav button:hover { background-color: #ffd700; color: #000; }
    .sub-section {
      display: none; margin-top: 10px; background-color: #fdfdfd; color: #333;
      padding: 10px; border-radius: 4px;
    }
    .sub-section.active { display: block; }
    /* النماذج العامة */
    .login-form, .language-modal, .city-modal, .cart-modal, .toast-message {
      display: none; position: fixed; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background-color: #fff; color: #333; padding: 20px;
      border: 2px solid #ffd700; z-index: 1101; border-radius: 8px;
      width: 80%; max-width: 600px;
    }
    .login-form h3, .language-modal h3, .city-modal h3, .cart-modal h3 {
      margin-bottom: 15px; text-align: center;
    }
    .login-form input, .language-modal button,
    .login-form input[type="text"],
    .login-form input[type="password"] {
      display: block; margin: 10px 0; padding: 8px; width: 100%;
      border: 1px solid #ffd700; border-radius: 4px;
    }
    .login-form button, .language-modal button, .city-modal button, 
    .cart-modal button.close-cart {
      background-color: #6a0dad; border: none; color: #fff; padding: 8px 12px;
      cursor: pointer; border-radius: 4px; margin-top: 10px;
      transition: background-color 0.3s;
    }
    .login-form button:hover, .language-modal button:hover, .city-modal button:hover,
    .cart-modal button.close-cart:hover { background-color: #ffd700; color: #000; }
    .login-form .alt-login {
      display: flex; justify-content: space-between; margin-top: 15px;
    }
    .login-form .alt-login button {
      width: 48%; display: flex; align-items: center; justify-content: center;
    }
    .login-form .alt-login img { width: 20px; height: 20px; margin-left: 5px; }
    .modal-overlay {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1100;
    }
    /* أيقونة سلة المشتريات */
    .cart-icon {
      position: fixed; bottom: 20px; right: 20px;
      background-color: #6a0dad; color: #fff; width: 50px; height: 50px;
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 24px; z-index: 1000;
      transition: background-color 0.3s;
    }
    .cart-icon:hover { background-color: #ffd700; color: #000; }
    /* زر واتساب العائم */
    .whatsapp-btn {
      position: fixed; bottom: 20px; left: 20px;
      background-color: #25D366; color: #fff; width: 50px; height: 50px;
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 24px; z-index: 1000;
      transition: background-color 0.3s;
    }
    .whatsapp-btn:hover { background-color: #128C7E; }
    /* نافذة خيارات الواتساب */
    .whatsapp-options-modal {
      display: none;
      position: fixed;
      bottom: 80px;
      left: 20px;
      background: #fff;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 8px;
      z-index: 1100;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .whatsapp-options-modal button {
      background-color: #25D366;
      border: none;
      color: #fff;
      padding: 8px 12px;
      margin: 5px 0;
      cursor: pointer;
      width: 100%;
      border-radius: 4px;
      transition: background-color 0.3s;
    }
    .whatsapp-options-modal button:hover { background-color: #128C7E; }
    /* بطاقات المنتجات */
    .products-container {
      display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-top: 20px;
    }
    .product-card {
      background: #fff; color: #333; border-radius: 8px; overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      flex: 1 1 300px; max-width: 600px; display: flex; flex-direction: row;
      margin-bottom: 15px;
    }
    .product-card img {
      width: 40%; height: auto; object-fit: cover;
      cursor: pointer;
    }
    .product-card .product-info {
      padding: 15px; display: flex; flex-direction: column; justify-content: center; width: 60%;
    }
    .product-card .product-title { font-size: 18px; margin-bottom: 5px; font-weight: bold; }
    .product-card .product-description { font-size: 14px; margin-bottom: 5px; }
    .product-card .product-price { font-size: 14px; margin-bottom: 5px; color: #555; }
    .product-card .product-city { font-size: 13px; color: #555; margin-bottom: 5px; }
    .product-card .quantity-input {
      width: 50px; padding: 4px; margin-bottom: 10px;
      border: 1px solid #ccc; border-radius: 4px; text-align: center;
    }
    .product-card button {
      background-color: #6a0dad; border: none; color: #fff; padding: 8px 12px;
      cursor: pointer; border-radius: 4px; align-self: flex-start;
      transition: background-color 0.3s;
      margin-top: 5px;
    }
    .product-card button:hover { background-color: #ffd700; color: #000; }
    /* زر المشاركة داخل بطاقة المنتج */
    .share-btn {
      background-color: #008CBA; margin-top: 5px;
    }
    /* بطاقات المطاعم والوجبات */
    .restaurants-container {
      display: flex; flex-direction: column; gap: 20px; margin-top: 20px;
    }
    .restaurant-card {
      background: #fff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      padding: 15px; display: flex; flex-direction: column; gap: 10px;
      position: relative;
    }
    .restaurant-info {
      display: flex; justify-content: space-between; align-items: center;
      font-size: 16px; font-weight: bold;
    }
    .restaurant-rating { color: #ff9900; }
    /* تم إضافة خانة المدينة تحت التقييم (غير قابلة للتعديل) */
    .restaurant-city {
      font-size: 14px;
      color: #555;
      margin-top: 5px;
      user-select: none;
    }
    .rating-stars span {
      font-size: 24px; cursor: pointer; color: #ccc; margin-right: 5px;
      transition: color 0.3s;
    }
    .rating-stars span.hover, .rating-stars span.active { color: #ffd700; }
    .restaurant-card button {
      background-color: #6a0dad; border: none; color: #fff; padding: 8px 12px;
      border-radius: 4px; cursor: pointer; width: fit-content;
      transition: background-color 0.3s;
    }
    .restaurant-card button:hover { background-color: #ffd700; color: #000; }
    .meals-container {
      display: flex; flex-direction: column; gap: 10px; margin-top: 10px;
    }
    .meal-item {
      display: flex; align-items: center; gap: 10px;
      background: #f1f1f1; border-radius: 6px; padding: 10px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .meal-item img {
      width: 100px; height: 100px; object-fit: cover; border-radius: 4px;
      cursor: pointer;
    }
    .meal-details {
      display: flex; flex-direction: column; flex-grow: 1;
    }
    .meal-name { font-size: 16px; font-weight: bold; }
    .meal-price { font-size: 14px; color: #555; margin: 5px 0; }
    .meal-details .quantity-input {
      width: 50px; padding: 4px; margin-bottom: 10px;
      border: 1px solid #ccc; border-radius: 4px; text-align: center;
    }
    .meal-details button {
      background-color: #6a0dad; border: none; color: #fff; padding: 6px 10px;
      border-radius: 4px; cursor: pointer; width: fit-content;
      transition: background-color 0.3s;
    }
    .meal-details button:hover { background-color: #ffd700; color: #000; }
    /* محتوى قسم العقارات */
    #realestate p { margin-top: 10px; }
    /* في بطاقات العقارات: إزالة خانة الكمية وإضافة حقل رقم صاحب الأرض */
    #realestate .product-info input.quantity-input { display: none; }
    /* حقل رقم صاحب الأرض مع تعطيله للمستخدمين العاديين */
    #realestate .owner-phone-input, 
    #cars .owner-phone-input {
      width: 100%; padding: 6px; margin-top: 5px;
      border: 1px solid #ccc; border-radius: 4px;
    }
    .owner-phone-input[disabled] { background-color: #e9e9e9; }
    /* تعديل زر العقارات ليصبح "مراسلة صاحب الأرض" */
    #realestate .contact-owner-btn, #cars .contact-owner-btn {
      background-color: #6a0dad; border: none; color: #fff; padding: 8px 12px;
      cursor: pointer; border-radius: 4px; margin-top: 5px;
      transition: background-color 0.3s;
    }
    #realestate .contact-owner-btn:hover, #cars .contact-owner-btn:hover { background-color: #ffd700; color: #000; }
    /* تم إزالة نوافذ التحرير الخاصة بالمدير */
    /* نافذة تكبير الصورة */
    #imageModal {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.8);
      z-index: 1300; align-items: center; justify-content: center;
    }
    #imageModal img {
      max-width: 90%; max-height: 90%;
      border: 5px solid #fff; border-radius: 8px;
    }
    /* تنسيق رسالة الترحيب (toast) */
    .toast-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      border: 2px solid #ffd700;
      padding: 20px;
      border-radius: 8px;
      z-index: 1200;
      text-align: center;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- الشريط العلوي الثابت القابل للسحب -->
  <div id="topBar" class="top-bar" draggable="true">
    <input id="searchInput" type="text" placeholder="البحث..." />
    <button class="search-btn" onclick="performSearch()">بحث</button>
    <button id="menuButton" onclick="toggleSideMenu()">القائمة</button>
  </div>

  <!-- شريط التنقل الرئيسي -->
  <nav class="main-nav">
    <button data-section="shopping" id="navShopping" onclick="showSection('shopping')">التسوق</button>
    <button data-section="realestate" id="navRealEstate" onclick="showSection('realestate')">العقارات</button>
    <button data-section="restaurants" id="navRestaurants" onclick="showSection('restaurants')">المطاعم</button>
    <button data-section="discounts" id="navDiscounts" onclick="showSection('discounts')">الخصومات</button>
    <button data-section="cars" id="navCars" onclick="showSection('cars')">السيارات</button>
  </nav>

  <!-- القائمة الجانبية -->
  <div id="sideMenu" class="side-menu">
    <h3 id="sideMenuTitle">القائمة</h3>
    <!-- تم إزالة عرض بيانات المدير -->
    <button id="sideMenuLoginButton" onclick="toggleLogin()">تسجيل الدخول</button>
    <button id="sideMenuChangeLangButton" onclick="toggleLanguage()">تغيير اللغة</button>
    <!-- تم إزالة زر تحرير المحتوى الخاص بالمدير -->
    <h3 id="socialLinksTitle">للتواصل والاستفسار</h3>
    <ul>
      <li><a class="social-link" href="https://wa.me/31465497"><img src="whatsapp-logo.png" alt="WhatsApp"> WhatsApp</a></li>
      <li><a class="social-link" href="#"><img src="facebook-logo.png" alt="Facebook"> Facebook</a></li>
      <li><a class="social-link" href="https://www.instagram.com/rahati_mlyn?igsh=MjM0NnViaDF5dXc="><img src="instagram-logo.png" alt="Instagram"> Instagram</a></li>
      <li><a class="social-link" href="https://www.snapchat.com/add/rahati_mlyn?share_id=rFDpyiVG_gM&locale=ar-MR"><img src="snapchat-logo.png" alt="Snapchat"> Snapchat</a></li>
      <li><a class="social-link" href="https://youtube.com/channel/UC2Ga1kALXLK03c11evnxTgA?si=koL3Kl2fW59tRdMB"><img src="youtube-logo.png" alt="YouTube"> YouTube</a></li>
      <li><a class="social-link" href="https://www.tiktok.com/@rahati_mlyn?_t=ZM-8ugAIAPYYC7&_r=1"><img src="Tik Tok-logo.png" alt="Tik Tok"> Tik Tok</a></li>
    </ul>
  </div>

  <!-- خلفية النماذج -->
  <div id="modalOverlay" class="modal-overlay" onclick="closeModals()"></div>

  <!-- نموذج تسجيل الدخول -->
  <div id="loginForm" class="login-form">
    <h3 id="loginFormTitle">تسجيل الدخول</h3>
    <input id="usernameInput" type="text" placeholder="البريد الإلكتروني" />
    <input id="passwordInput" type="password" placeholder="كلمة المرور" />
    <button id="loginButton" type="button" onclick="performLogin()">دخول</button>
    <button id="loginCloseButton" type="button" onclick="toggleLogin()">إغلاق</button>
    <hr style="margin:15px 0;">
    <div style="display:flex; gap:10px; justify-content: center;">
      <button onclick="alert('تسجيل الدخول باستخدام Google (متكامل)')" style="display:flex; align-items:center; gap:5px;">
        <img src="google-logo.png" alt="Google" style="width:20px;height:20px;"> تسجيل الدخول بـ Google
      </button>
      <button onclick="alert('تسجيل الدخول باستخدام Facebook (متكامل)')" style="display:flex; align-items:center; gap:5px;">
        <img src="facebook-logo.png" alt="Facebook" style="width:20px;height:20px;"> تسجيل الدخول بـ Facebook
      </button>
    </div>
  </div>

  <!-- نموذج اختيار اللغة -->
  <div id="languageModal" class="language-modal">
    <h3>اختر اللغة</h3>
    <button onclick="setLanguage('ar')">العربية</button>
    <button onclick="setLanguage('en')">English</button>
    <button onclick="setLanguage('fr')">Français</button>
  </div>

  <!-- نموذج اختيار المدينة -->
  <div id="cityModal" class="city-modal">
    <h3>اختر المدينة</h3>
    <button onclick="setCity('نواكشوط')">نواكشوط</button>
    <button onclick="setCity('نواذيبو')">نواذيبو</button>
  </div>

  <!-- نافذة سلة المشتريات -->
  <div id="cartModal" class="cart-modal">
    <h3>سلة المشتريات</h3>
    <ul id="cartItemsList"></ul>
    <!-- عرض المجموع الكلي -->
    <p id="cartTotal">المجموع الكلي: 0</p>
    <button onclick="sendOrder()">إرسال الطلب</button>
    <button class="close-cart" onclick="closeCart()">إغلاق السلة</button>
  </div>

  <!-- نافذة واتساب خيارات -->
  <div id="whatsappOptionsModal" class="whatsapp-options-modal">
    <button onclick="window.open('https://wa.me/37250515?text=' + encodeURIComponent('لدي منتج لعرضه 🛍'), '_blank')">
      منتج لبيعه (شخصي/منزلي)
    </button>
    <button onclick="window.open('https://wa.me/30441417?text=' + encodeURIComponent('لدي منزل لعرضه 🏠'), '_blank')">
      منزل لعرضه (بيع/إيجار)
    </button>
    <button onclick="window.open('https://wa.me/36633323?text=' + encodeURIComponent('لدي مطعم لعرضه 🍽'), '_blank')">
      مطعم لعرض وجباته
    </button>
    <button onclick="window.open('https://wa.me/34302024?text=' + encodeURIComponent('لدي سيارة لعرضها 🚗'), '_blank')">
      سيارة لعرضها (بيع/إيجار)
    </button>
    <button style="background-color:#ccc; color:#000;" onclick="closeWhatsAppOptions()">إغلاق</button>
  </div>

  <!-- نافذة تكبير الصورة -->
  <div id="imageModal" onclick="closeImageModal()">
    <img id="modalImage" src="" alt="تكبير الصورة">
  </div>

  <!-- قسم التسوق -->
  <div id="shopping" class="section active">
    <h2 id="sectionShoppingTitle">قسم التسوق</h2>
    <div class="sub-nav">
      <button id="subNavHomeShopping" onclick="showSubSection('homeShopping')">منزلي</button>
      <button id="subNavPersonalShopping" onclick="showSubSection('personalShopping')">شخصي</button>
    </div>
    <div id="homeShopping" class="sub-section active">
      <h3 id="subSectionHomeShoppingTitle">التسوق المنزلي</h3>
      <div class="products-container">
        <!-- منتجات افتراضية لقسم التسوق -->
        <div class="product-card" data-product-id="prod1">
          <img src="photo/5e8da508d613dd55248cbc9693d0d2e7.jpg" alt=" زوافان " onclick="openImageModal(this.src)">
          <div class="product-info">
            <div class="product-title">منتج منزلي 1</div>
            <div class="product-description"> صوره زوفان .</div>
            <!-- السعر المضاف جديداً -->
            <div class="product-price">  $ :السعر/</div>
            <div class="product-city">المدينة: <span class="cityName">شانغ هاي</span></div>
            <input type="number" min="1" value="1" class="quantity-input">
            <button onclick="addToCart('ززوافان', this, 'shopping', 'product1.jpg')">أضف إلى السلة</button>
            <button class="share-btn" onclick="shareProduct(this)">مشاركة</button>
          </div>
        </div>
        <div class="product-card" data-product-id="prod2">
          <img src="product2.jpg" alt="منتج منزلي 2" onclick="openImageModal(this.src)">
          <div class="product-info">
            <div class="product-title">منتج منزلي 2</div>
            <div class="product-description">وصف مختصر للمنتج منزلي 2.</div>
            <div class="product-price">السعر: 150</div>
            <div class="product-city">المدينة: <span class="cityName">-</span></div>
            <input type="number" min="1" value="1" class="quantity-input">
            <button onclick="addToCart('منتج منزلي 2', this, 'shopping', 'product2.jpg')">أضف إلى السلة</button>
            <button class="share-btn" onclick="shareProduct(this)">مشاركة</button>
          </div>
        </div>
      </div>
    </div>
    <div id="personalShopping" class="sub-section">
      <h3 id="subSectionPersonalShoppingTitle">التسوق الشخصي</h3>
      <div class="products-container">
        <div class="product-card" data-product-id="prod3">
          <img src="product3.jpg" alt="منتج شخصي 1" onclick="openImageModal(this.src)">
          <div class="product-info">
            <div class="product-title">منتج شخصي 1</div>
            <div class="product-description">وصف مختصر للمنتج شخصي 1.</div>
            <div class="product-price">السعر: 200</div>
            <div class="product-city">المدينة: <span class="cityName">-</span></div>
            <input type="number" min="1" value="1" class="quantity-input">
            <button onclick="addToCart('منتج شخصي 1', this, 'shopping', 'product3.jpg')">أضف إلى السلة</button>
            <button class="share-btn" onclick="shareProduct(this)">مشاركة</button>
          </div>
        </div>
        <div class="product-card" data-product-id="prod4">
          <img src="product4.jpg" alt="منتج شخصي 2" onclick="openImageModal(this.src)">
          <div class="product-info">
            <div class="product-title">منتج شخصي 2</div>
            <div class="product-description">وصف مختصر للمنتج شخصي 2.</div>
            <div class="product-price">السعر: 250</div>
            <div class="product-city">المدينة: <span class="cityName">-</span></div>
            <input type="number" min="1" value="1" class="quantity-input">
            <button onclick="addToCart('منتج شخصي 2', this, 'shopping', 'product4.jpg')">أضف إلى السلة</button>
            <button class="share-btn" onclick="shareProduct(this)">مشاركة</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- قسم العقارات -->
  <div id="realestate" class="section">
    <h2 id="sectionRealEstateTitle">قسم العقارات</h2>
    <div class="sub-nav">
      <button id="subNavRentEstate" onclick="showSubSection('rentEstate')">للإيجار</button>
      <button id="subNavSaleEstate" onclick="showSubSection('saleEstate')">للبيع</button>
    </div>
    <div id="rentEstate" class="sub-section active">
      <h3 id="subSectionRentEstateTitle">منازل للإيجار</h3>
      <p>عرض منازل للإيجار...</p>
      <div class="products-container">
        <div class="product-card" data-product-id="estate1">
          <img src="realestate1.jpg" alt="منزل للإيجار" onclick="openImageModal(this.src)">
          <div class="product-info">
            <div class="product-title">منزل للإيجار</div>
            <div class="product-description">وصف مختصر لمنزل للإيجار.</div>
            <div class="product-price">السعر: 300</div>
            <div class="product-city">المدينة: <span class="cityName">-</span></div>
            <input type="text" placeholder="رقم صاحب الأرض" class="owner-phone-input" id="ownerPhone_estate1" disabled>
            <button class="contact-owner-btn" onclick="contactOwner(this, 'realestate')">مراسلة صاحب الأرض</button>
          </div>
        </div>
      </div>
    </div>
    <div id="saleEstate" class="sub-section">
      <h3 id="subSectionSaleEstateTitle">منازل للبيع</h3>
      <p>عرض منازل للبيع...</p>
      <div class="products-container">
        <div class="product-card" data-product-id="estate2">
          <img src="realestate2.jpg" alt="منزل للبيع" onclick="openImageModal(this.src)">
          <div class="product-info">
            <div class="product-title">منزل للبيع</div>
            <div class="product-description">وصف مختصر لمنزل للبيع.</div>
            <div class="product-price">السعر: 350</div>
            <div class="product-city">المدينة: <span class="cityName">-</span></div>
            <input type="text" placeholder="رقم صاحب الأرض" class="owner-phone-input" id="ownerPhone_estate2" disabled>
            <button class="contact-owner-btn" onclick="contactOwner(this, 'realestate')">مراسلة صاحب الأرض</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- قسم المطاعم -->
  <div id="restaurants" class="section">
    <h2 id="sectionRestaurantsTitle">قسم المطاعم</h2>
    <div class="restaurants-container">
      <div class="restaurant-card" id="restaurant1">
        <div class="restaurant-info">
          <div class="restaurant-name" id="restaurantName1">مطعم النور</div>
          <div class="restaurant-rating" id="ratingDisplay1">تقييم: 4.5 (10 تقييم)</div>
        </div>
        <!-- خانة المدينة المُضافة (غير قابلة للتعديل) -->
        <div class="restaurant-city" id="restaurantCity1">المدينة: نواكشوط</div>
        <div class="rating-stars" id="ratingStars1">
          <span onclick="rateRestaurant('restaurant1', 1, this)">★</span>
          <span onclick="rateRestaurant('restaurant1', 2, this)">★</span>
          <span onclick="rateRestaurant('restaurant1', 3, this)">★</span>
          <span onclick="rateRestaurant('restaurant1', 4, this)">★</span>
          <span onclick="rateRestaurant('restaurant1', 5, this)">★</span>
        </div>
        <button onclick="toggleMeals('meals1')">عرض الوجبات</button>
        <div id="meals1" class="meals-container" style="display: none;">
          <!-- خمس وجبات افتراضية -->
          <div class="meal-item" data-meal-name="وجبة 1" data-meal-image="meal1.jpg">
            <img src="meal1.jpg" alt="وجبة 1" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 1</div>
              <div class="meal-price">السعر: 50 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 1', 50, this, 'restaurants', 'مطعم النور', 'meal1.jpg')">أضف إلى السلة</button>
            </div>
          </div>
          <div class="meal-item" data-meal-name="وجبة 2" data-meal-image="meal2.jpg">
            <img src="meal2.jpg" alt="وجبة 2" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 2</div>
              <div class="meal-price">السعر: 65 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 2', 65, this, 'restaurants', 'مطعم النور', 'meal2.jpg')">أضف إلى السلة</button>
            </div>
          </div>
          <div class="meal-item" data-meal-name="وجبة 3" data-meal-image="meal3.jpg">
            <img src="meal3.jpg" alt="وجبة 3" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 3</div>
              <div class="meal-price">السعر: 70 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 3', 70, this, 'restaurants', 'مطعم النور', 'meal3.jpg')">أضف إلى السلة</button>
            </div>
          </div>
          <div class="meal-item" data-meal-name="وجبة 4" data-meal-image="meal4.jpg">
            <img src="meal4.jpg" alt="وجبة 4" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 4</div>
              <div class="meal-price">السعر: 80 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 4', 80, this, 'restaurants', 'مطعم النور', 'meal4.jpg')">أضف إلى السلة</button>
            </div>
          </div>
          <div class="meal-item" data-meal-name="وجبة 5" data-meal-image="meal5.jpg">
            <img src="meal5.jpg" alt="وجبة 5" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 5</div>
              <div class="meal-price">السعر: 90 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 5', 90, this, 'restaurants', 'مطعم النور', 'meal5.jpg')">أضف إلى السلة</button>
            </div>
          </div>
        </div>
      </div>
      <div class="restaurant-card" id="restaurant2">
        <div class="restaurant-info">
          <div class="restaurant-name" id="restaurantName2">مطعم الرفاه</div>
          <div class="restaurant-rating" id="ratingDisplay2">تقييم: 4.2 (8 تقييم)</div>
        </div>
        <!-- خانة المدينة المُضافة (غير قابلة للتعديل) -->
        <div class="restaurant-city" id="restaurantCity2">المدينة: نواذيبو</div>
        <div class="rating-stars" id="ratingStars2">
          <span onclick="rateRestaurant('restaurant2', 1, this)">★</span>
          <span onclick="rateRestaurant('restaurant2', 2, this)">★</span>
          <span onclick="rateRestaurant('restaurant2', 3, this)">★</span>
          <span onclick="rateRestaurant('restaurant2', 4, this)">★</span>
          <span onclick="rateRestaurant('restaurant2', 5, this)">★</span>
        </div>
        <button onclick="toggleMeals('meals2')">عرض الوجبات</button>
        <div id="meals2" class="meals-container" style="display: none;">
          <!-- خمس وجبات افتراضية -->
          <div class="meal-item" data-meal-name="وجبة 6" data-meal-image="meal6.jpg">
            <img src="meal6.jpg" alt="وجبة 6" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 6</div>
              <div class="meal-price">السعر: 40 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 6', 40, this, 'restaurants', 'مطعم الرفاه', 'meal6.jpg')">أضف إلى السلة</button>
            </div>
          </div>
          <div class="meal-item" data-meal-name="وجبة 7" data-meal-image="meal7.jpg">
            <img src="meal7.jpg" alt="وجبة 7" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 7</div>
              <div class="meal-price">السعر: 55 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 7', 55, this, 'restaurants', 'مطعم الرفاه', 'meal7.jpg')">أضف إلى السلة</button>
            </div>
          </div>
          <div class="meal-item" data-meal-name="وجبة 8" data-meal-image="meal8.jpg">
            <img src="meal8.jpg" alt="وجبة 8" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 8</div>
              <div class="meal-price">السعر: 60 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 8', 60, this, 'restaurants', 'مطعم الرفاه', 'meal8.jpg')">أضف إلى السلة</button>
            </div>
          </div>
          <div class="meal-item" data-meal-name="وجبة 9" data-meal-image="meal9.jpg">
            <img src="meal9.jpg" alt="وجبة 9" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 9</div>
              <div class="meal-price">السعر: 70 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 9', 70, this, 'restaurants', 'مطعم الرفاه', 'meal9.jpg')">أضف إلى السلة</button>
            </div>
          </div>
          <div class="meal-item" data-meal-name="وجبة 10" data-meal-image="meal10.jpg">
            <img src="meal10.jpg" alt="وجبة 10" onclick="openImageModal(this.src)">
            <div class="meal-details">
              <div class="meal-name">وجبة 10</div>
              <div class="meal-price">السعر: 80 أوقية</div>
              <input type="number" min="1" value="1" class="quantity-input">
              <button onclick="addMealToCart('وجبة 10', 80, this, 'restaurants', 'مطعم الرفاه', 'meal10.jpg')">أضف إلى السلة</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- قسم الخصومات -->
  <div id="discounts" class="section">
    <h2 id="sectionDiscountsTitle">قسم الخصومات</h2>
    <p id="discountsText">هنا يتم عرض العروض والتخفيضات الخاصة...</p>
    <div class="products-container">
      <div class="product-card" data-product-id="disc1">
        <img src="discount1.jpg" alt="عرض تخفيض 1" onclick="openImageModal(this.src)">
        <div class="product-info">
          <div class="product-title">عرض تخفيض 1</div>
          <div class="product-description">وصف مختصر للعرض.</div>
          <div class="product-price">السعر: 120</div>
          <div class="product-city">المدينة: <span class="cityName">-</span></div>
          <input type="number" min="1" value="1" class="quantity-input">
          <button onclick="addToCart('عرض تخفيض 1', this, 'discounts', 'discount1.jpg')">أضف إلى السلة</button>
          <button class="share-btn" onclick="shareProduct(this)">مشاركة</button>
        </div>
      </div>
      <div class="product-card" data-product-id="disc2">
        <img src="discount2.jpg" alt="عرض تخفيض 2" onclick="openImageModal(this.src)">
        <div class="product-info">
          <div class="product-title">عرض تخفيض 2</div>
          <div class="product-description">وصف مختصر للعرض.</div>
          <div class="product-price">السعر: 180</div>
          <div class="product-city">المدينة: <span class="cityName">-</span></div>
          <input type="number" min="1" value="1" class="quantity-input">
          <button onclick="addToCart('عرض تخفيض 2', this, 'discounts', 'discount2.jpg')">أضف إلى السلة</button>
          <button class="share-btn" onclick="shareProduct(this)">مشاركة</button>
        </div>
      </div>
    </div>
  </div>

  <!-- قسم السيارات -->
  <div id="cars" class="section">
    <h2 id="sectionCarsTitle">قسم السيارات</h2>
    <div class="sub-nav">
      <button id="subNavSellCars" onclick="showSubSection('sellCars')">للبيع</button>
      <button id="subNavRentCars" onclick="showSubSection('rentCars')">للإيجار</button>
    </div>
    <div id="sellCars" class="sub-section active">
      <h3 id="subSectionSellCarsTitle">سيارات للبيع</h3>
      <div class="products-container">
        <div class="product-card" data-product-id="car1">
          <img src="car1.jpg" alt="سيارة للبيع" onclick="openImageModal(this.src)">
          <div class="product-info">
            <div class="product-title">سيارة للبيع 1</div>
            <div class="product-description">وصف مختصر للسيارة المعروضة للبيع.</div>
            <div class="product-price">السعر: 500</div>
            <div class="product-city">المدينة: <span class="cityName">-</span></div>
            <input type="text" placeholder="رقم صاحب السيارة" class="owner-phone-input" disabled>
          </div>
        </div>
      </div>
    </div>
    <div id="rentCars" class="sub-section">
      <h3 id="subSectionRentCarsTitle">سيارات للإيجار</h3>
      <div class="products-container">
        <div class="product-card" data-product-id="car2">
          <img src="car2.jpg" alt="سيارة للإيجار" onclick="openImageModal(this.src)">
          <div class="product-info">
            <div class="product-title">سيارة للإيجار 1</div>
            <div class="product-description">وصف مختصر للسيارة المعروضة للإيجار.</div>
            <div class="product-price">السعر: 300</div>
            <div class="product-city">المدينة: <span class="cityName">-</span></div>
            <input type="text" placeholder="رقم صاحب السيارة" class="owner-phone-input" disabled>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- أيقونة سلة المشتريات -->
  <div class="cart-icon" onclick="openCart()">🛒</div>
  <!-- زر واتساب العائم -->
  <div class="whatsapp-btn" onclick="openWhatsApp()">💬</div>

  <!-- قوالب العناصر المخفية لإعادة استخدامها (تم الاحتفاظ بها بدون تغييرات لأنها مخصصة للإضافات في حالة وجود مدير) -->
  <div id="templates" style="display:none;">
    <!-- قالب التسوق -->
    <div id="template-shopping">
      <div class="product-card" data-product-id="newProd">
        <img src="placeholder.jpg" alt="منتج جديد" onclick="openImageModal(this.src)">
        <div class="product-info">
          <div class="product-title">منتج جديد</div>
          <div class="product-description">وصف المنتج الجديد.</div>
          <div class="product-price">السعر: 100</div>
          <div class="product-city">المدينة: <span class="cityName">-</span></div>
          <input type="number" min="1" value="1" class="quantity-input">
          <button onclick="addToCart('منتج جديد', this, 'shopping', 'placeholder.jpg')">أضف إلى السلة</button>
          <button class="share-btn" onclick="shareProduct(this)">مشاركة</button>
        </div>
      </div>
    </div>
    <!-- باقي القوالب لم تعد مطلوبة حالياً -->
  </div>

  <!-- رسالة الترحيب (toast) -->
  <div id="toastMessage" class="toast-message" style="display:none;"></div>

  <script>
    // متغيرات الحالة
    let isLoggedIn = false;
    let currentCity = "";
    // تعريف كائن لتخزين تقييمات المستخدم لكل مطعم (يمكن تغيير التقييم لاحقاً)
    let userRatings = {};
    // المجموع الكلي لسلة المشتريات
    let totalCartPrice = 0;

    // دوال السحب للشريط العلوي
    const topBar = document.getElementById("topBar");
    topBar.addEventListener("dragstart", function(e) {
      e.dataTransfer.setData("text/plain", null);
    });
    topBar.addEventListener("dragend", function(e) {
      topBar.style.left = e.pageX - topBar.offsetWidth / 2 + "px";
    });

    // إظهار وإخفاء النماذج والقائمة الجانبية
    function toggleSideMenu() {
      document.getElementById('sideMenu').classList.toggle('open');
    }
    document.addEventListener('click', function(e) {
      const sideMenu = document.getElementById('sideMenu');
      const menuButton = document.getElementById('menuButton');
      if (sideMenu.classList.contains('open') && !sideMenu.contains(e.target) && e.target !== menuButton) {
        sideMenu.classList.remove('open');
      }
    });
    function toggleLogin() {
      const loginForm = document.getElementById('loginForm');
      const overlay = document.getElementById('modalOverlay');
      loginForm.style.display = (loginForm.style.display === 'block') ? 'none' : 'block';
      overlay.style.display = (overlay.style.display === 'block') ? 'none' : 'block';
    }
    function toggleLanguage() {
      const langModal = document.getElementById('languageModal');
      const overlay = document.getElementById('modalOverlay');
      langModal.style.display = 'block';
      overlay.style.display = 'block';
    }
    function toggleCityModal() {
      const cityModal = document.getElementById('cityModal');
      const overlay = document.getElementById('modalOverlay');
      cityModal.style.display = 'block';
      overlay.style.display = 'block';
    }
    function closeModals() {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('languageModal').style.display = 'none';
      document.getElementById('cityModal').style.display = 'none';
      document.getElementById('modalOverlay').style.display = 'none';
      closeCart();
      closeImageModal();
      closeWhatsAppOptions();
    }
    function showToast(message) {
      const toast = document.getElementById('toastMessage');
      toast.innerText = message;
      toast.style.display = 'block';
      setTimeout(() => { toast.style.display = 'none'; }, 2500);
    }
    function performSearch() {
      const query = document.getElementById('searchInput').value.toLowerCase();
      document.querySelectorAll('.product-card').forEach(card => {
        const title = card.querySelector('.product-title').innerText.toLowerCase();
        const desc = card.querySelector('.product-description').innerText.toLowerCase();
        card.style.display = (title.includes(query) || desc.includes(query)) ? "flex" : "none";
      });
      showToast("تم البحث عن: " + query);
    }
    function showSection(sectionId) {
      document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
      document.getElementById(sectionId).classList.add('active');
    }
    function showSubSection(subSectionId) {
      const activeSection = document.querySelector('.section.active');
      if(!activeSection) return;
      activeSection.querySelectorAll('.sub-section').forEach(sub => sub.classList.remove('active'));
      const target = document.getElementById(subSectionId);
      if(target) target.classList.add('active');
    }

    // دوال تكبير الصورة عند الضغط عليها
    function openImageModal(imgSrc) {
      const imageModal = document.getElementById("imageModal");
      const modalImage = document.getElementById("modalImage");
      modalImage.src = imgSrc;
      imageModal.style.display = "flex";
    }
    function closeImageModal() {
      document.getElementById("imageModal").style.display = "none";
    }

    // دوال سلة المشتريات
    let cartItems = [];
    function updateCartTotal() {
      totalCartPrice = 0;
      cartItems.forEach(entry => {
        totalCartPrice += Number(entry.price) * Number(entry.qty);
      });
      document.getElementById('cartTotal').innerText = "المجموع الكلي: " + totalCartPrice;
    }
    function addToCart(item, btn, section, imgSrc) {
      const quantity = btn.parentElement.querySelector('.quantity-input').value;
      // محاولة الحصول على السعر من العنصر الذي يحتوي على الكلاس "product-price"
      let priceText = btn.parentElement.querySelector('.product-price') ? btn.parentElement.querySelector('.product-price').innerText : "";
      let price = 0;
      if(priceText) {
        // استخراج الرقم من النص (مثال: "السعر: 100")
        price = parseFloat(priceText.replace(/[^0-9\.]/g, ''));
      }
      cartItems.push({item: item, qty: quantity, section: section, img: imgSrc, price: price});
      showToast('تم إضافة "' + item + '" (الكمية: ' + quantity + ') إلى السلة');
      updateCartTotal();
    }
    function addMealToCart(mealName, price, btn, section, restaurantName, imgSrc) {
      const quantity = btn.parentElement.querySelector('.quantity-input').value;
      cartItems.push({item: mealName, price: price, qty: quantity, section: section, restaurant: restaurantName, img: imgSrc});
      showToast('تم إضافة "' + mealName + '" (الكمية: ' + quantity + ') إلى السلة');
      updateCartTotal();
    }
    function openCart() {
      const cartModal = document.getElementById('cartModal');
      const cartList = document.getElementById('cartItemsList');
      cartList.innerHTML = "";
      if(cartItems.length === 0) {
        cartList.innerHTML = "<li>السلة فارغة</li>";
      } else {
        cartItems.forEach(function(entry, index) {
          let extra = "";
          if(entry.section === "restaurants" && entry.restaurant) {
            extra = " - مطعم: " + entry.restaurant;
          }
          if((entry.section === "shopping" || entry.section === "discounts") && entry.img){
            extra += " - صورة: " + entry.img;
          }
          cartList.innerHTML += "<li>" +
            "<span>" + entry.item + extra + " - كمية: " + entry.qty + " - السعر: " + (entry.price * entry.qty) + "</span>" +
            " <span class='remove-item' onclick='removeFromCart(" + index + ")' style='cursor:pointer;'>❌</span>" +
            "</li>";
        });
      }
      cartModal.style.display = 'block';
      document.getElementById('modalOverlay').style.display = 'block';
    }
    function closeCart() {
      document.getElementById('cartModal').style.display = 'none';
      document.getElementById('modalOverlay').style.display = 'none';
    }
    function removeFromCart(index) {
      cartItems.splice(index, 1);
      openCart();
      updateCartTotal();
    }

    // دعم اللغات
    const translations = {
      ar: {
        searchPlaceholder: "البحث...",
        menuButton: "القائمة",
        sideMenuTitle: "القائمة",
        sideMenuLoginButton: "تسجيل الدخول",
        sideMenuChangeLangButton: "تغيير اللغة",
        socialLinksTitle: "للتواصل والاستفسار",
        loginFormTitle: "تسجيل الدخول",
        usernamePlaceholder: "البريد الإلكتروني",
        passwordPlaceholder: "كلمة المرور",
        loginButton: "دخول",
        loginCloseButton: "إغلاق",
        navShopping: "التسوق",
        navRealEstate: "العقارات",
        navRestaurants: "المطاعم",
        navDiscounts: "الخصومات",
        navCars: "السيارات",
        sectionShoppingTitle: "قسم التسوق",
        subNavHomeShopping: "منزلي",
        subNavPersonalShopping: "شخصي",
        subSectionHomeShoppingTitle: "التسوق المنزلي",
        subSectionPersonalShoppingTitle: "التسوق الشخصي",
        sectionRealEstateTitle: "قسم العقارات",
        subNavRentEstate: "للإيجار",
        subNavSaleEstate: "للبيع",
        subSectionRentEstateTitle: "منازل للإيجار",
        subSectionSaleEstateTitle: "منازل للبيع",
        sectionRestaurantsTitle: "قسم المطاعم",
        sectionDiscountsTitle: "قسم الخصومات",
        sectionCarsTitle: "قسم السيارات",
        discountsText: "هنا يتم عرض العروض والتخفيضات الخاصة..."
      },
      en: {},
      fr: {}
    };
    function applyTranslations(lang) {
      const t = translations[lang];
      document.getElementById('searchInput').placeholder = t.searchPlaceholder;
      document.getElementById('menuButton').innerText = t.menuButton;
      document.getElementById('sideMenuTitle').innerText = t.sideMenuTitle;
      document.getElementById('sideMenuLoginButton').innerText = t.sideMenuLoginButton;
      document.getElementById('sideMenuChangeLangButton').innerText = t.sideMenuChangeLangButton;
      document.getElementById('socialLinksTitle').innerText = t.socialLinksTitle;
      document.getElementById('loginFormTitle').innerText = t.loginFormTitle;
      document.getElementById('usernameInput').placeholder = t.usernamePlaceholder;
      document.getElementById('passwordInput').placeholder = t.passwordPlaceholder;
      document.getElementById('loginButton').innerText = t.loginButton;
      document.getElementById('loginCloseButton').innerText = t.loginCloseButton;
      document.getElementById('navShopping').innerText = t.navShopping;
      document.getElementById('navRealEstate').innerText = t.navRealEstate;
      document.getElementById('navRestaurants').innerText = t.navRestaurants;
      document.getElementById('navDiscounts').innerText = t.navDiscounts;
      document.getElementById('navCars').innerText = t.navCars;
      document.getElementById('sectionShoppingTitle').innerText = t.sectionShoppingTitle;
      document.getElementById('subNavHomeShopping').innerText = t.subNavHomeShopping;
      document.getElementById('subNavPersonalShopping').innerText = t.subNavPersonalShopping;
      document.getElementById('subSectionHomeShoppingTitle').innerText = t.subSectionHomeShoppingTitle;
      document.getElementById('subSectionPersonalShoppingTitle').innerText = t.subSectionPersonalShoppingTitle;
      document.getElementById('sectionRealEstateTitle').innerText = t.sectionRealEstateTitle;
      document.getElementById('subNavRentEstate').innerText = t.subNavRentEstate;
      document.getElementById('subNavSaleEstate').innerText = t.subNavSaleEstate;
      document.getElementById('subSectionRentEstateTitle').innerText = t.subSectionRentEstateTitle;
      document.getElementById('subSectionSaleEstateTitle').innerText = t.subSectionSaleEstateTitle;
      document.getElementById('sectionRestaurantsTitle').innerText = t.sectionRestaurantsTitle;
      document.getElementById('sectionDiscountsTitle').innerText = t.sectionDiscountsTitle;
      document.getElementById('sectionCarsTitle').innerText = t.sectionCarsTitle;
      document.getElementById('discountsText').innerText = t.discountsText;
    }
    function setLanguage(lang) {
      document.documentElement.lang = lang;
      document.body.style.direction = (lang === 'ar') ? 'rtl' : 'ltr';
      applyTranslations(lang);
      closeModals();
    }
    function setCity(city) {
      currentCity = city;
      document.querySelectorAll('.product-card').forEach(card => {
        let cardCity = card.getAttribute("data-city");
        if(!cardCity) {
          card.setAttribute("data-city", currentCity);
          let span = card.querySelector('.cityName');
          if(span) span.innerText = currentCity;
          card.style.display = "flex";
        } else {
          card.style.display = (cardCity === currentCity) ? "flex" : "none";
          let span = card.querySelector('.cityName');
          if(span) span.innerText = currentCity;
        }
      });
      showToast("تم اختيار المدينة: " + currentCity);
      closeModals();
    }
    function openWhatsApp() {
      document.getElementById('whatsappOptionsModal').style.display = 'block';
      document.getElementById('modalOverlay').style.display = 'block';
    }
    function closeWhatsAppOptions() {
      document.getElementById('whatsappOptionsModal').style.display = 'none';
      document.getElementById('modalOverlay').style.display = 'none';
    }
    function toggleMeals(id) {
      const mealsContainer = document.getElementById(id);
      mealsContainer.style.display = (mealsContainer.style.display === "none" || mealsContainer.style.display === "") ? "block" : "none";
    }
    // دالة تقييم المطعم مع إمكانية تعديل التقييم
    const restaurantRatings = {
      'restaurant1': { avg: 4.5, count: 10 },
      'restaurant2': { avg: 4.2, count: 8 }
    };
    function rateRestaurant(restaurantId, ratingValue, starElement) {
      if (!isLoggedIn) {
        toggleLogin();
        showToast("الرجاء تسجيل الدخول للتقييم");
        return;
      }
      let data = restaurantRatings[restaurantId] || { avg: 0, count: 0 };
      let sum = data.avg * data.count;
      if(userRatings[restaurantId] === undefined) {
        // أول تقييم للمطعم من قبل المستخدم
        data.count += 1;
        sum += ratingValue;
        userRatings[restaurantId] = ratingValue;
      } else {
        // تحديث تقييم المستخدم السابق
        let oldRating = userRatings[restaurantId];
        sum = sum - oldRating + ratingValue;
        userRatings[restaurantId] = ratingValue;
      }
      let newAvg = sum / data.count;
      restaurantRatings[restaurantId] = { avg: newAvg, count: data.count };
      // تحديث العرض
      const displayElement = (restaurantId === 'restaurant1') ? document.getElementById('ratingDisplay1') : document.getElementById('ratingDisplay2');
      displayElement.innerText = "تقييم: " + newAvg.toFixed(1) + " (" + data.count + " تقييم)";
      const stars = starElement.parentElement.querySelectorAll('span');
      stars.forEach((star, index) => {
        if(index < ratingValue) star.classList.add('active');
        else star.classList.remove('active');
      });
      showToast("شكراً لتقييمك✨!");
    }
    // دالة تسجيل الدخول البسيطة (تم إزالة التفرقة بين المدير والمستخدم)
    function performLogin() {
      const email = document.getElementById('usernameInput').value.trim();
      const password = document.getElementById('passwordInput').value;
      if(email !== "" && password !== "") {
        isLoggedIn = true;
        showToast("مرحبا بك❤️‍🩹");
      } else {
        showToast("يرجى إدخال البريد الإلكتروني وكلمة المرور");
        return;
      }
      toggleLogin();
    }
    // يتم إزالة دالة تسجيل الدخول بواسطة Google الخاصة بالمدير
  </script>
</body>
</html>
